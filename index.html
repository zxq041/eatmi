<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>eatmi.pl ‚Äî Z≈Ç√≥≈º swojego boxa i zam√≥w online</title>
  <meta name="description" content="eatmi.pl ‚Äî Zapakuj w≈Çasnego lunch boxa lub wybierz gotowy zestaw. Zam√≥w online szybko i wygodnie." />
  <link rel="icon" type="image/png" href="favicon.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {
              yellow: '#FFC107',
              dark: '#111827',
              light: '#F9FAFB'
            },
            cat: {
              slone: '#F59E0B',
              slodkie: '#EC4899',
              zdrowe: '#10B981',
              napoj: '#3B82F6'
            }
          },
          boxShadow: {
            soft: '0 10px 30px rgba(0,0,0,.08)',
            glass: '0 8px 25px rgba(0,0,0,.12)'
          },
          borderRadius: { xl2: '1.25rem' }
        }
      }
    }
  </script>
  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest"></script>
  <!-- React 18 + Babel -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    html{scroll-behavior:smooth}
    .glass{background:rgba(255,255,255,0.6);backdrop-filter:blur(10px)}
    .neo{box-shadow: 10px 10px 30px rgba(0,0,0,.08), -10px -10px 30px rgba(255,255,255,.7)}
    .liquid{background:linear-gradient(135deg, rgba(255,255,255,.6), rgba(255,255,255,.35)); backdrop-filter: blur(12px);}
    .drag-hover{outline:2px dashed #11182733; outline-offset: -8px}

    /* Delikatna animacja "glow" wok√≥≈Ç logotypu eatmi */
    @keyframes logo-glow {
      0%,100% {
        box-shadow: 0 0 0 0 rgba(255,193,7,0.0);
      }
      50% {
        box-shadow: 0 0 0 8px rgba(255,193,7,0.35);
      }
    }
    .logo-glow {
      animation: logo-glow 3s ease-in-out infinite;
    }

    /* Animacja toasta i pasek postƒôpu */
    @keyframes toast-enter {
      0% {
        opacity: 0;
        transform: translateY(16px) scale(0.96);
      }
      60% {
        opacity: 1;
        transform: translateY(0) scale(1.02);
      }
      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    @keyframes toast-progress {
      from { width: 100%; }
      to   { width: 0%; }
    }

    .toast-enter {
      animation: toast-enter 0.35s ease-out forwards;
    }

    .toast-bar {
      animation: toast-progress 2.5s linear forwards;
    }
  </style>
</head>
<body class="bg-brand-light text-gray-900">
  <!-- Happy Hour Bar -->
  <div id="topBar" class="w-full text-center text-sm bg-brand-yellow text-gray-900 py-1.5 font-medium">
    <span>üéâ Dzi≈õ ‚àí15% z kodem <b>HAPPY15</b> do 15:00</span>
  </div>

  <!-- App Root -->
  <div id="root"></div>

  <!-- React App -->
  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;

    // --- Data ---
    const CATEGORIES = [
      { id:'slone',   name:'S≈Çone',   color:'cat.slone' },
      { id:'slodkie', name:'S≈Çodkie', color:'cat.slodkie' },
      { id:'zdrowe',  name:'Zdrowe',  color:'cat.zdrowe' },
      { id:'napoj',   name:'Nap√≥j',   color:'cat.napoj' },
    ];

    const MENU = {
      slone: [
        { id:'burger-chicken', name:'Chicken Burger', desc:'kurczak, mi√≥d-muszt.', img:'https://images.unsplash.com/photo-1606756790138-261d2b21cd75?q=80&w=800&auto=format&fit=crop' },
        { id:'burger-beef',    name:'Beef Classic',   desc:'wo≈Çowina, cheddar',   img:'https://images.unsplash.com/photo-1606756790138-261d2b21cd75?q=80&w=800&auto=format&fit=crop' },
        { id:'wrap',           name:'Wrap Tex-Mex',   desc:'kurczak, salsa',      img:'https://images.unsplash.com/photo-1606756790138-261d2b21cd75?q=80&w=800&auto=format&fit=crop' },
      ],
      slodkie: [
        { id:'brownie',    name:'Brownie',    desc:'gƒôste, czekoladowe', img:'https://images.unsplash.com/photo-1606756790138-261d2b21cd75?q=80&w=800&auto=format&fit=crop' },
        { id:'cheesecake', name:'Cheesecake', desc:'klasyczny',          img:'https://images.unsplash.com/photo-1606756790138-261d2b21cd75?q=80&w=800&auto=format&fit=crop' },
        { id:'cookie',     name:'Cookie',     desc:'z czekoladƒÖ',        img:'https://images.unsplash.com/photo-1606756790138-261d2b21cd75?q=80&w=800&auto=format&fit=crop' },
      ],
      zdrowe: [
        { id:'salad-caesar', name:'Sa≈Çatka Caesar', desc:'kurczak, parmezan', img:'https://images.unsplash.com/photo-1606756790138-261d2b21cd75?q=80&w=800&auto=format&fit=crop' },
        { id:'bowl-quinoa',  name:'Bowl Quinoa',    desc:'quinoa, hummus',   img:'https://images.unsplash.com/photo-1606756790138-261d2b21cd75?q=80&w=800&auto=format&fit=crop' },
        { id:'veggie-sticks',name:'Warzywne Sticks',desc:'marchew, dip',     img:'https://images.unsplash.com/photo-1606756790138-261d2b21cd75?q=80&w=800&auto=format&fit=crop' },
      ],
      napoj: [
        { id:'cola',      name:'Cola 0,5l',   desc:'sch≈Çodzona',      img:'https://images.unsplash.com/photo-1606756790138-261d2b21cd75?q=80&w=800&auto=format&fit=crop' },
        { id:'lemoniada', name:'Lemoniada',   desc:'domowa',          img:'https://images.unsplash.com/photo-1606756790138-261d2b21cd75?q=80&w=800&auto=format&fit=crop' },
        { id:'woda',      name:'Woda 0,5l',   desc:'gaz./niegaz.',    img:'https://images.unsplash.com/photo-1606756790138-261d2b21cd75?q=80&w=800&auto=format&fit=crop' },
      ],
    };

    // Rozmiary box√≥w do konfiguratora (ma≈Çy/≈õredni/du≈ºy)
    const BOX_RULES = {
      1: {
        name:'Box ma≈Çy',
        limits: { slone:1, slodkie:1, zdrowe:0, napoj:1 },
        price: 38
      },
      2: {
        name:'Box ≈õredni',
        limits: { slone:1, slodkie:1, zdrowe:1, napoj:1 },
        price: 58
      },
      3: {
        name:'Box du≈ºy',
        limits: { slone:2, slodkie:1, zdrowe:2, napoj:1 },
        price: 79
      },
    };

    // --- Oferta ≈õniadaniowa: 3 gotowe boxy ---
    const BREAKFAST_BOXES = [
      {
        id: 'small',
        name: 'Box ≈õniadaniowy ma≈Çy',
        price: 38,
        variants: [
          {
            id: 'small-classic',
            label: 'Ma≈Çy klasyczny',
            items: [
              { id:'s-kurczak', name:'Kanapka z kurczakiem' },
              { id:'s-musli',   name:'Musli granola' },
              { id:'s-sok',     name:'Sok pomara≈Ñczowy' },
            ],
          },
          {
            id: 'small-vege',
            label: 'Ma≈Çy vege',
            items: [
              { id:'s-vege-jajeczna', name:'Kanapka z pastƒÖ jajecznƒÖ' },
              { id:'s-vege-musli',    name:'Musli granola' },
              { id:'s-vege-sok',      name:'Sok pomara≈Ñczowy' },
            ],
          },
        ],
      },
      {
        id: 'medium',
        name: 'Box ≈õniadaniowy ≈õredni',
        price: 58,
        variants: [
          {
            id: 'medium-classic',
            label: '≈öredni klasyczny',
            items: [
              { id:'m-kurczak',   name:'Kanapka z kurczakiem' },
              { id:'m-musli',     name:'Musli granola' },
              { id:'m-sok',       name:'Sok pomara≈Ñczowy' },
              { id:'m-cezar',     name:'Sa≈Çatka Caesar' },
            ],
          },
          {
            id: 'medium-vege',
            label: '≈öredni vege',
            items: [
              { id:'m-vege-jajko-avo',  name:'Kanapka z pastƒÖ jajecznƒÖ i awokado' },
              { id:'m-vege-burak-kozi', name:'Sa≈Çatka z burakiem i kozim serem' },
              { id:'m-vege-musli',      name:'Musli granola' },
              { id:'m-vege-sok',        name:'Sok pomara≈Ñczowy' },
            ],
          },
        ],
      },
      {
        id: 'large',
        name: 'Box ≈õniadaniowy du≈ºy',
        price: 79,
        variants: [
          {
            id: 'large-classic',
            label: 'Du≈ºy klasyczny',
            items: [
              { id:'l-kurczak',    name:'Kanapka z kurczakiem' },
              { id:'l-indyk',      name:'Kanapka z indykiem' },
              { id:'l-cezar',      name:'Sa≈Çatka Caesar' },
              { id:'l-tost',       name:'Tost francuski' },
              { id:'l-musli',      name:'Musli granola' },
              { id:'l-sok',        name:'Sok pomara≈Ñczowy' },
            ],
          },
          {
            id: 'large-vege',
            label: 'Du≈ºy vege',
            items: [
              { id:'l-vege-jajko-avo',  name:'Kanapka z pastƒÖ jajecznƒÖ i awokado' },
              { id:'l-vege-camembert',  name:'Kanapka z serem camembert i awokado' },
              { id:'l-vege-tost',       name:'Tost francuski' },
              { id:'l-vege-musli',      name:'Musli granola' },
              { id:'l-vege-sok',        name:'Sok pomara≈Ñczowy' },
            ],
          },
        ],
      },
    ];

    // --- Oferta lunchowa ---
    const LUNCH_BOXES = [
      { id:'rb1', name:'Protein Power', price:39, items:[MENU.slone[1], MENU.zdrowe[0], MENU.napoj[2]] },
      { id:'rb2', name:'Sweet & Salty', price:35, items:[MENU.slone[0], MENU.slodkie[0], MENU.napoj[1]] },
      { id:'rb3', name:'Fit Day',       price:42, items:[MENU.zdrowe[1], MENU.slodkie[2], MENU.napoj[2], MENU.slone[2]] },
    ];

    // --- Dodatki w koszyku ---
    const EXTRA_ITEMS = [
      { id:'extra-brownie',  name:'Brownie do kawy',       price: 9 },
      { id:'extra-lemoniada',name:'Domowa lemoniada 0,4l', price: 12 },
      { id:'extra-cookie',   name:'Cookie czekoladowe',    price: 7 },
    ];

    // --- Utils ---
    const useLocalStorage = (key, initial) => {
      const [state, setState] = useState(() => {
        try { return JSON.parse(localStorage.getItem(key)) ?? initial } catch { return initial }
      });
      useEffect(() => { localStorage.setItem(key, JSON.stringify(state)) }, [key, state]);
      return [state, setState];
    };
    const currency = (n) => new Intl.NumberFormat('pl-PL', { style:'currency', currency:'PLN' }).format(n);

    // --- Toast (powiadomienia) ---
    const ToastContext = React.createContext();
    const useToast = () => React.useContext(ToastContext);

    const ToastProvider = ({children}) => {
      const [toast, setToast] = useState(null);
      const timeoutRef = React.useRef(null);

      const show = (message) => {
        setToast(message);
        if (timeoutRef.current) clearTimeout(timeoutRef.current);
        timeoutRef.current = setTimeout(() => setToast(null), 2500);
      };

      const close = () => {
        if (timeoutRef.current) clearTimeout(timeoutRef.current);
        setToast(null);
      };

      return (
        <ToastContext.Provider value={{ show }}>
          {children}
          {toast && (
            <div className="fixed bottom-24 left-1/2 -translate-x-1/2 z-[80] pointer-events-none">
              <div className="relative pointer-events-auto toast-enter bg-white/95 border border-emerald-200 shadow-glass rounded-2xl px-4 py-3 min-w-[260px] max-w-[90vw] flex items-start gap-3">
                <div className="w-9 h-9 rounded-full bg-emerald-100 flex items-center justify-center text-emerald-600 text-lg">
                  ‚úì
                </div>
                <div className="flex-1">
                  <div className="text-[10px] font-semibold uppercase tracking-[0.12em] text-emerald-600">
                    Dodano do koszyka
                  </div>
                  <div className="text-sm text-gray-900 mt-0.5">
                    {toast}
                  </div>
                </div>
                <button
                  type="button"
                  onClick={close}
                  className="ml-2 text-gray-400 hover:text-gray-600 text-xl leading-none"
                  aria-label="Zamknij powiadomienie"
                >
                  √ó
                </button>
                <div className="absolute left-4 right-4 -bottom-1.5 h-1 rounded-full overflow-hidden bg-emerald-50">
                  <div className="toast-bar h-full bg-emerald-400"></div>
                </div>
              </div>
            </div>
          )}
        </ToastContext.Provider>
      );
    };

    // --- Components ---
    const Logo = () => (
      <a href="#/" className="flex items-center gap-3 group">
        <div className="w-10 h-10 rounded-2xl bg-white flex items-center justify-center border border-gray-100 overflow-hidden shadow-soft logo-glow">
          <img
            src="https://i.imgur.com/f9TN0Gh.png"
            alt="eatmi.pl ‚Äî logo"
            loading="lazy"
            className="w-9 h-9 object-contain transition-transform duration-500 group-hover:-rotate-6 group-hover:scale-110"
          />
        </div>
        <span className="font-extrabold tracking-tight">
          eatmi<span className="text-brand-yellow">.pl</span>
        </span>
      </a>
    );

    // Cart Context
    const CartContext = React.createContext();
    const CartProvider = ({children}) => {
      const [cart, setCart] = useLocalStorage('eatmi-cart', []);
      const { show } = useToast() || {};

      const add = (entry) => {
        const newItem = { id: (crypto?.randomUUID ? crypto.randomUUID() : `${Date.now()}-${Math.random()}`), qty: 1, ...entry };
        setCart(prev => [...prev, newItem]);
        if (show) {
          show(`Dodano do koszyka: ${entry.name}`);
        }
      };
      const remove  = (id) => setCart(prev => prev.filter(i => i.id !== id));
      const setQty  = (id, qty) => setCart(prev => prev.map(i => i.id === id ? {...i, qty: Math.max(1, qty|0)} : i));
      const incQty  = (id) => setCart(prev => prev.map(i => i.id === id ? {...i, qty: (i.qty||1)+1} : i));
      const decQty  = (id) => setCart(prev => prev.map(i => i.id === id ? {...i, qty: Math.max(1, (i.qty||1)-1)} : i));
      const clear   = () => setCart([]);
      const lineTotal = (i) => (i.price || 0) * (i.qty || 1);
      const total  = useMemo(() => cart.reduce((s,i)=> s + lineTotal(i), 0), [cart]);
      return <CartContext.Provider value={{cart, add, remove, setQty, incQty, decQty, clear, lineTotal, total}}>{children}</CartContext.Provider>
    }
    const useCart = () => React.useContext(CartContext);

    const CartButton = () => {
      const { cart, total } = useCart();
      return (
        <a href="#/koszyk" className="relative inline-flex items-center gap-2 border border-gray-200 bg-white px-4 py-2 rounded-xl shadow-soft hover:shadow-md transition">
          <i data-lucide="shopping-cart" className="w-5 h-5"></i>
          <span className="text-sm font-semibold">{currency(total)}</span>
          <span className="absolute -top-2 -right-2 bg-brand-yellow text-gray-900 text-xs font-bold w-6 h-6 rounded-full grid place-items-center">
            {cart.reduce((s,i)=>s+(i.qty||1),0)}
          </span>
        </a>
      )
    }

    const Header = ({ onOpenAuth }) => (
      <header className="sticky top-0 z-40 bg-white/80 backdrop-blur border-b border-gray-200">
        <div className="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
          <Logo />
          <nav className="hidden md:flex items-center gap-6 text-sm">
            <a href="#zapakuj"   className="hover:text-gray-900 text-gray-600">Zapakuj boxa</a>
            <a href="#sniadanie" className="hover:text-gray-900 text-gray-600">≈öniadania</a>
            <a href="#oferta"    className="hover:text-gray-900 text-gray-600">Lunch</a>
            <a href="#o-nas"     className="hover:text-gray-900 text-gray-600">O nas</a>
            <a href="#kontakt"   className="hover:text-gray-900 text-gray-600">Kontakt</a>
          </nav>

          <div className="flex items-center gap-3">
            {/* Konto / member button desktop */}
            <button
              type="button"
              onClick={onOpenAuth}
              className="hidden md:inline-flex items-center gap-2 border border-gray-200 bg-white px-4 py-2 rounded-xl shadow-soft hover:shadow-md transition text-sm font-semibold text-gray-800"
            >
              <i data-lucide="user" className="w-4 h-4"></i>
              <span>Konto</span>
            </button>

            {/* Mobile ikonka konta */}
            <button
              type="button"
              onClick={onOpenAuth}
              className="md:hidden inline-flex items-center justify-center w-10 h-10 rounded-xl border border-gray-200 bg-white shadow-soft"
              aria-label="Moje konto"
            >
              <i data-lucide="user" className="w-5 h-5"></i>
            </button>

            <CartButton />
          </div>
        </div>
      </header>
    );

    const Hero = () => (
      <section className="relative overflow-hidden">
        <div className="max-w-6xl mx-auto px-4 py-12 md:py-20 grid md:grid-cols-2 gap-10 items-center">
          <div>
            <div className="inline-flex items-center gap-2 mb-3 px-4 py-2 rounded-full bg-white/80 border border-gray-200 shadow-soft animate-pulse">
              <span className="text-xl">üëã</span>
              <span className="text-sm md:text-base font-semibold text-gray-900">
                Cze≈õƒá, mi≈Ço Ciƒô widzieƒá ‚Äî na co masz dzi≈õ ochotƒô?
              </span>
            </div>

            <h1 className="text-4xl md:text-5xl font-extrabold leading-tight">
              Z≈Ç√≥≈º swojego <span className="text-brand-yellow">Lunch Boxa</span> i{' '}
              <span className="underline decoration-brand-yellow">zam√≥w online</span>
            </h1>
            <p className="mt-4 text-gray-600 max-w-prose">
              Wybieraj z kategorii: s≈Çone, s≈Çodkie, zdrowe i napoje.
              Skorzystaj z gotowych box√≥w ≈õniadaniowych albo zapakuj w≈Çasny zestaw.
            </p>
            <div className="mt-6 flex flex-wrap gap-3">
              <a href="#zapakuj" className="inline-flex items-center gap-2 bg-brand-yellow text-gray-900 font-semibold px-6 py-3 rounded-xl2 shadow-soft hover:scale-[1.02] transition">
                <i data-lucide="shopping-bag" className="w-5 h-5"></i>
                Zapakuj w≈Çasnego boxa
              </a>
              <a href="#sniadanie" className="inline-flex items-center gap-2 border border-gray-300 bg-white text-gray-900 font-semibold px-6 py-3 rounded-xl2 shadow-soft hover:scale-[1.02] transition">
                <i data-lucide="sunrise" className="w-5 h-5"></i>
                Zobacz ≈õniadania
              </a>
            </div>
          </div>
          <div className="relative">
            <img
              alt="Burger"
              loading="lazy"
              className="w-full rounded-2xl shadow-soft neo"
              src="image.png"
            />
            <div className="absolute -bottom-4 -right-4 bg-white rounded-xl2 px-4 py-3 shadow-glass border border-gray-200 text-sm">
              ‚≠ê 4.9/5 ‚Äî 2k+ zam√≥wie≈Ñ
            </div>
          </div>
        </div>
      </section>
    );

    const SectionTitle = ({eyebrow, title, subtitle}) => (
      <div className="text-center max-w-2xl mx-auto">
        {eyebrow && <div className="text-xs uppercase tracking-widest text-gray-500">{eyebrow}</div>}
        <h2 className="text-3xl md:text-4xl font-extrabold mt-1">{title}</h2>
        {subtitle && <p className="text-gray-600 mt-2">{subtitle}</p>}
      </div>
    );

    const BoxCard = ({id, name, limits, price}) => (
      <a href={`#/box/${id}`} className="group block bg-white border border-gray-200 rounded-2xl p-6 hover:shadow-soft transition">
        <div className="flex items-center justify-between">
          <h3 className="font-bold text-lg">{name}</h3>
          <span className="text-gray-900 font-extrabold">{currency(price)}</span>
        </div>
        <ul className="mt-3 text-sm text-gray-600 space-y-1">
          {Object.entries(limits).filter(([,v])=>v>0).map(([k,v])=> (
            <li key={k} className="flex items-center gap-2">
              <span className="w-2 h-2 rounded-full" style={{background: getCatColor(k)}}></span>
              {CATEGORIES.find(c=>c.id===k)?.name}: <b className="ml-1">{v}√ó</b>
            </li>
          ))}
        </ul>
        <div className="mt-4 inline-flex items-center gap-2 text-gray-700 group-hover:gap-3 transition">
          Wybierz <i data-lucide="arrow-right" className="w-4 h-4"></i>
        </div>
      </a>
    );

    // >>> Karty oferty ≈õniadaniowej
    const BreakfastBoxCard = ({ box, onAdd }) => {
      return (
        <div className="bg-white border border-gray-200 rounded-2xl p-5 flex flex-col">
          <div className="flex items-center justify-between">
            <h3 className="font-bold text-lg">{box.name}</h3>
            <span className="font-extrabold">{currency(box.price)}</span>
          </div>
          <p className="mt-1 text-xs text-gray-500">
            Ka≈ºdy box w wersji klasycznej lub vege.
          </p>

          <div className="mt-4 grid grid-cols-1 gap-4">
            {box.variants.map(variant => (
              <div
                key={variant.id}
                className="border border-gray-200 rounded-xl p-3"
              >
                <div className="flex items-center justify-between">
                  <div className="text-sm font-semibold">{variant.label}</div>
                  {variant.label.toLowerCase().includes('vege') && (
                    <span className="text-xs px-2 py-0.5 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-100">
                      vege
                    </span>
                  )}
                </div>
                <div className="mt-2 flex flex-wrap gap-2 text-xs text-gray-600">
                  {variant.items.map(it => (
                    <span
                      key={it.id}
                      className="px-2 py-1 rounded-full border border-gray-200"
                    >
                      {it.name}
                    </span>
                  ))}
                </div>
                <button
                  onClick={() => onAdd(variant)}
                  className="mt-3 inline-flex items-center justify-center gap-2 bg-brand-yellow text-gray-900 font-semibold px-4 py-2 rounded-xl hover:scale-[1.02] transition"
                >
                  <i data-lucide="plus" className="w-4 h-4"></i>
                  Dodaj {variant.label.toLowerCase()} do koszyka
                </button>
              </div>
            ))}
          </div>
        </div>
      );
    };

    // >>> Karty oferty lunchowej
    const LunchBoxCard = ({box, onAdd}) => {
      const cover = box.items?.[0]?.img;
      return (
        <div className="bg-white border border-gray-200 rounded-2xl p-5 flex flex-col">
          {cover && (
            <img
              src={cover}
              alt={box.name}
              loading="lazy"
              className="w-full h-36 object-cover rounded-xl mb-3"
            />
          )}
          <div className="flex items-center justify-between">
            <h3 className="font-bold text-lg">{box.name}</h3>
            <span className="font-extrabold">{currency(box.price)}</span>
          </div>
          <div className="mt-3 flex flex-wrap gap-2 text-xs text-gray-600">
            {box.items.map((it)=> (
              <span key={it.id||it.name} className="px-2 py-1 rounded-full border border-gray-200">
                {it.name}
              </span>
            ))}
          </div>
          <button
            onClick={onAdd}
            className="mt-4 inline-flex items-center justify-center gap-2 bg-brand-yellow text-gray-900 font-semibold px-4 py-2 rounded-xl hover:scale-[1.02] transition"
          >
            <i data-lucide="plus" className="w-4 h-4"></i> Dodaj do koszyka
          </button>
        </div>
      );
    };

    // --- BoxBuilder ---
    const BoxBuilder = ({boxId}) => {
      const rules = BOX_RULES[boxId];
      const orderCats = CATEGORIES.filter(c => rules.limits[c.id] > 0).map(c => c.id);
      const [selected, setSelected] = useState({ slone:[], slodkie:[], zdrowe:[], napoj:[] });
      const { add } = useCart();

      // PodglƒÖd zdjƒôcia (modal)
      const [preview, setPreview] = useState({ open:false, src:'', alt:'' });
      const openPreview  = (src, alt) => setPreview({ open:true, src, alt });
      const closePreview = () => setPreview({ open:false, src:'', alt:'' });

      // Modal info o przeciƒÖganiu
      const [hintOpen, setHintOpen] = useState(() => {
        try { return !JSON.parse(localStorage.getItem('eatmi-dnd-hint-dismissed')||'false'); } catch { return true; }
      });
      const closeHint = () => { setHintOpen(false); try { localStorage.setItem('eatmi-dnd-hint-dismissed', 'true'); } catch {} };

      // Aktywna kategoria
      const currentCatId = useMemo(() => {
        for (const id of orderCats) {
          const lim = rules.limits[id] || 0;
          if ((selected[id]?.length || 0) < lim) return id;
        }
        return null;
      }, [orderCats, rules.limits, selected]);

      const removeItem = (cat, id) => setSelected(prev => ({...prev, [cat]: prev[cat].filter(i=> i.id!==id)}));

      const onDrop = (e) => {
        e.preventDefault();
        try {
          const data = JSON.parse(e.dataTransfer.getData('text/plain'));
          if(!data || !data.category || !data.item) return;

          if (currentCatId && data.category !== currentCatId) return;

          const cat = data.category;
          const limit = rules.limits[cat] || 0;
          if (selected[cat].some(i => i.id === data.item.id)) return;
          if (selected[cat].length >= limit) return;
          setSelected(prev => ({...prev, [cat]: [...prev[cat], data.item]}));
        } catch(err) {}
      };

      const onDragOver = (e) => { e.preventDefault(); e.currentTarget.classList.add('drag-hover'); };
      const onDragLeave = (e) => { e.currentTarget.classList.remove('drag-hover'); };
      const onDropEnd   = (e) => { e.currentTarget.classList.remove('drag-hover'); onDrop(e); };

      const canAddToCart = orderCats.every(id => (selected[id]?.length || 0) === (rules.limits[id] || 0));
      const handleAdd = () => {
        add({ type:'custom-box', name: rules.name, price: rules.price, items: Object.values(selected).flat() });
        window.location.hash = '#/koszyk';
      };

      return (
        <section className="py-10">
          <div className="max-w-6xl mx-auto px-4">
            <a href="#/" className="inline-flex items-center gap-2 text-sm text-gray-600">
              <i data-lucide="arrow-left" className="w-4 h-4"></i> Wr√≥ƒá
            </a>

            <div className="mt-4 bg-white border border-gray-200 rounded-2xl p-5 shadow-soft">
              <div className="flex items-center justify-between">
                <h2 className="font-extrabold text-xl">{rules.name}</h2>
                <div className="text-gray-900 font-extrabold">{currency(rules.price)}</div>
              </div>
              <p className="text-gray-600 text-sm mt-1">
                {currentCatId ? (
                  <>
                    Krok {orderCats.indexOf(currentCatId)+1}/{orderCats.length}: wybierz pozycje z kategorii{' '}
                    <b>{CATEGORIES.find(c=>c.id===currentCatId)?.name}</b> i przeciƒÖgnij do boxa.
                  </>
                ) : (
                  <>Wszystkie kategorie uzupe≈Çnione. Tw√≥j box jest gotowy do dodania do koszyka.</>
                )}
              </p>

              <div
                onDragOver={onDragOver}
                onDragLeave={onDragLeave}
                onDrop={onDropEnd}
                className="mt-4 rounded-2xl border-2 border-dashed border-gray-200 p-4 grid grid-cols-2 md:grid-cols-4 gap-3"
              >
                {orderCats.map(catId => (
                  <div key={catId} className="bg-gray-50 rounded-xl p-3 border border-gray-200">
                    <div className="flex items-center justify-between text-xs">
                      <span className="font-semibold">
                        {CATEGORIES.find(c=>c.id===catId)?.name}
                      </span>
                      <span className="text-gray-500">
                        {selected[catId].length}/{rules.limits[catId]}
                      </span>
                    </div>
                    <div className="mt-2 flex flex-col gap-2">
                      {selected[catId].map(it => (
                        <div
                          key={it.id}
                          className="w-full text-left text-sm bg-white border border-gray-200 rounded-lg p-2 flex items-center justify-between gap-2"
                        >
                          <span className="truncate">{it.name}</span>
                          <button
                            onClick={() => removeItem(catId, it.id)}
                            className="shrink-0 w-6 h-6 grid place-items-center rounded-md bg-red-500 text-white"
                            aria-label={`Usu≈Ñ ${it.name}`}
                            title="Usu≈Ñ"
                          >
                            <span className="text-lg leading-none">‚àí</span>
                          </button>
                        </div>
                      ))}
                    </div>
                  </div>
                ))}
              </div>

              {canAddToCart && (
                <div className="mt-3 flex items-start gap-2 bg-amber-50 border border-amber-200 rounded-xl p-3 text-sm text-amber-900">
                  <span className="text-lg">‚ú®</span>
                  <div>
                    <div className="font-semibold">Tw√≥j box jest gotowy!</div>
                    <p>
                      Zanim przejdziesz dalej, mo≈ºesz dorzuciƒá jeszcze jeden box albo p√≥≈∫niej w koszyku kliknƒÖƒá dodatki
                      (brownie, lemoniada itp.), aby powiƒôkszyƒá zam√≥wienie jednym klikniƒôciem.
                    </p>
                  </div>
                </div>
              )}

              <button
                disabled={!canAddToCart}
                onClick={handleAdd}
                className={`mt-4 w-full inline-flex items-center justify-center gap-2 rounded-xl px-4 py-3 font-semibold ${
                  canAddToCart ? 'bg-brand-yellow text-gray-900' : 'bg-gray-200 text-gray-500 cursor-not-allowed'
                }`}
              >
                <i data-lucide="check-circle" className="w-5 h-5"></i>
                Dodaj box do koszyka
              </button>
            </div>

            <div className="mt-6">
              {currentCatId ? (
                <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                  <div className="bg-white border border-gray-200 rounded-2xl shadow-soft overflow-hidden">
                    <div
                      className="px-5 py-3 font-semibold text-white"
                      style={{background: getCatColor(currentCatId)}}
                    >
                      {CATEGORIES.find(c=>c.id===currentCatId)?.name}
                    </div>
                    <div className="p-4 space-y-3">
                      {MENU[currentCatId].map(item => (
                        <div
                          key={item.id}
                          draggable
                          onDragStart={(e)=> e.dataTransfer.setData('text/plain', JSON.stringify({category: currentCatId, item}))}
                          className="group bg-white border border-gray-200 rounded-xl px-3 py-2 hover:shadow-soft transition cursor-grab"
                        >
                          <div className="flex items-center gap-3">
                            <button
                              type="button"
                              onClick={(ev)=>{ ev.preventDefault(); ev.stopPropagation(); openPreview(item.img, item.name); }}
                              className="shrink-0 rounded-lg overflow-hidden border border-gray-200 focus:outline-none focus:ring-2 focus:ring-brand-yellow"
                              title="Powiƒôksz zdjƒôcie"
                              aria-label={`Powiƒôksz zdjƒôcie: ${item.name}`}
                            >
                              <img
                                src={item.img}
                                alt={item.name}
                                loading="lazy"
                                draggable="false"
                                className="w-10 h-10 object-cover"
                              />
                            </button>
                            <div className="min-w-0">
                              <div className="font-semibold text-sm leading-tight">{item.name}</div>
                              <div className="text-xs text-gray-600 truncate">{item.desc}</div>
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                </div>
              ) : (
                <div className="text-sm text-gray-600">
                  Wszystkie wymagane kategorie zosta≈Çy wybrane. Mo≈ºesz dodaƒá box do koszyka powy≈ºej.
                </div>
              )}
            </div>

            {preview.open && (
              <div className="fixed inset-0 z-[60] bg-black/70 flex items-center justify-center p-4" onClick={closePreview}>
                <div className="relative bg-white rounded-2xl shadow-glass max-w-3xl w-full">
                  <button
                    onClick={closePreview}
                    className="absolute top-2 right-2 p-2 rounded-full bg-white/90 border border-gray-200 shadow-soft"
                    aria-label="Zamknij podglƒÖd"
                  >
                    <i data-lucide="x" className="w-4 h-4"></i>
                  </button>
                  <img src={preview.src} alt={preview.alt} className="w-full h-auto rounded-2xl" />
                </div>
              </div>
            )}

            {hintOpen && (
              <div className="fixed inset-0 z-[70] bg-black/60 flex items-center justify-center p-4" role="dialog" aria-modal="true">
                <div className="relative w-full max-w-lg bg-white rounded-2xl shadow-glass border border-gray-200 p-5">
                  <button
                    onClick={closeHint}
                    className="absolute top-3 right-3 p-2 rounded-full bg-white border border-gray-200 shadow-soft hover:bg-gray-50"
                    aria-label="Zamknij okno"
                    title="Zamknij"
                  >
                    <i data-lucide="x" className="w-4 h-4"></i>
                  </button>
                  <div className="flex items-start gap-3">
                    <div className="shrink-0 w-10 h-10 rounded-xl grid place-items-center bg-brand-yellow">
                      <i data-lucide="hand" className="w-5 h-5"></i>
                    </div>
                    <div>
                      <h3 className="text-lg font-extrabold">Jak dodaƒá produkt do boxa?</h3>
                      <p className="mt-1 text-gray-700">
                        PrzeciƒÖgaj pozycje z aktywnej kategorii do strefy boxa. Po uzupe≈Çnieniu limitu kategoria znika i pojawia siƒô nastƒôpna.
                      </p>
                    </div>
                  </div>
                  <div className="mt-4 flex justify-end">
                    <button onClick={closeHint} className="px-4 py-2 rounded-xl bg-gray-900 text-white font-semibold">
                      Rozumiem
                    </button>
                  </div>
                </div>
              </div>
            )}
          </div>
        </section>
      );
    }

    // >>> Koszyk + dodatki
    const Koszyk = () => {
      const { cart, remove, clear, total, incQty, decQty, setQty, lineTotal, add } = useCart();
      const goToCheckout = () => window.location.hash = '#/zamowienie';
      return (
        <section className="py-10">
          <div className="max-w-6xl mx-auto px-4">
            <a href="#/" className="inline-flex items-center gap-2 text-sm text-gray-600">
              <i data-lucide="arrow-left" className="w-4 h-4"></i> Wr√≥ƒá
            </a>
            <h2 className="text-2xl font-extrabold mt-3">Koszyk</h2>
            {cart.length === 0 ? (
              <p className="text-gray-600 mt-2">Tw√≥j koszyk jest pusty.</p>
            ) : (
              <>
                <div className="mt-6 grid md:grid-cols-3 gap-6 items-start">
                  <div className="md:col-span-2 space-y-4">
                    {cart.map(item => (
                      <div key={item.id} className="bg-white border border-gray-200 rounded-2xl p-4 flex items-center justify-between gap-4">
                        <div className="min-w-0">
                          <div className="font-bold">{item.name}</div>
                          {item.items && (
                            <div className="mt-1 text-sm text-gray-600 flex flex-wrap gap-2">
                              {item.items.map((i)=> (
                                <span key={i.id||i.name} className="px-2 py-1 rounded-full border border-gray-200">
                                  {i.name}
                                </span>
                              ))}
                            </div>
                          )}
                        </div>

                        <div className="flex items-center gap-4 shrink-0">
                          <div className="flex items-center gap-2">
                            <button
                              onClick={()=> decQty(item.id)}
                              className="w-8 h-8 rounded-lg border border-gray-200 grid place-items-center"
                            >
                              ‚àí
                            </button>
                            <input
                              value={item.qty||1}
                              onChange={(e)=> setQty(item.id, parseInt(e.target.value||'1',10))}
                              className="w-12 text-center border border-gray-200 rounded-lg py-1"
                              inputMode="numeric"
                              pattern="[0-9]*"
                            />
                            <button
                              onClick={()=> incQty(item.id)}
                              className="w-8 h-8 rounded-lg border border-gray-200 grid place-items-center"
                            >
                              +
                            </button>
                          </div>

                          <div className="text-right">
                            <div className="font-extrabold">{currency(lineTotal(item))}</div>
                            <div className="text-xs text-gray-500">({currency(item.price)} / szt.)</div>
                          </div>

                          <button
                            onClick={()=> remove(item.id)}
                            className="text-red-600 hover:underline"
                          >
                            Usu≈Ñ
                          </button>
                        </div>
                      </div>
                    ))}
                  </div>
                  <aside className="bg-white border border-gray-200 rounded-2xl p-5">
                    <div className="flex items-center justify-between">
                      <span className="font-semibold">Suma</span>
                      <span className="font-extrabold">{currency(total)}</span>
                    </div>
                    <div className="mt-4 grid gap-2">
                      <button
                        onClick={goToCheckout}
                        className="w-full bg-brand-yellow text-gray-900 font-semibold rounded-xl px-4 py-3"
                      >
                        Przejd≈∫ do zam√≥wienia
                      </button>
                      <button
                        onClick={clear}
                        className="w-full bg-gray-100 text-gray-700 rounded-xl px-4 py-3"
                      >
                        Wyczy≈õƒá koszyk
                      </button>
                    </div>
                  </aside>
                </div>

                <div className="mt-10 border-t border-gray-200 pt-6">
                  <h3 className="text-lg font-bold flex items-center gap-2">
                    <span>Mo≈ºe dorzucisz co≈õ jeszcze?</span>
                    <span className="text-xs px-2 py-0.5 rounded-full bg-gray-900 text-white">1 klik i dodane</span>
                  </h3>
                  <p className="text-sm text-gray-600 mt-1">
                    S≈Çodki dodatek lub nap√≥j czƒôsto robi r√≥≈ºnicƒô ‚Äî szczeg√≥lnie przy wiƒôkszych zam√≥wieniach.
                  </p>
                  <div className="mt-4 flex flex-wrap gap-3">
                    {EXTRA_ITEMS.map(extra => (
                      <button
                        key={extra.id}
                        onClick={() => add({ type:'extra', name: extra.name, price: extra.price })}
                        className="flex items-center gap-2 px-4 py-2 rounded-full bg-white border border-gray-200 shadow-soft text-sm hover:shadow-md hover:-translate-y-0.5 transition"
                      >
                        <span className="text-base">+</span>
                        <span>{extra.name}</span>
                        <span className="font-semibold text-gray-900">{currency(extra.price)}</span>
                      </button>
                    ))}
                  </div>
                </div>
              </>
            )}
          </div>
        </section>
      );
    }

    const Zamowienie = () => {
      const { cart, total, clear, lineTotal } = useCart();
      const [form, setForm] = useState({
        imieNazwisko:'', telefon:'', email:'', miasto:'', kod:'', ulica:'', nrBud:'', pietro:'', lokal:'', uwagi:'', faktura:false, nip:'', firma:''
      });

      const handle = (k,v)=> setForm(s=> ({...s,[k]:v}))
      const submit = () => {
        if(!form.imieNazwisko || !form.telefon || !form.miasto || !form.ulica) {
          alert('Uzupe≈Çnij wymagane pola');
          return;
        }
        alert('Zam√≥wienie z≈Ço≈ºone! (p≈Çatno≈õƒá online ‚Äî symulacja)');
        clear();
        window.location.hash = '#/';
      }

      return (
        <section className="py-10">
          <div className="max-w-6xl mx-auto px-4">
            <a href="#/koszyk" className="inline-flex items-center gap-2 text-sm text-gray-600">
              <i data-lucide="arrow-left" className="w-4 h-4"></i> Wr√≥ƒá do koszyka
            </a>
            <h2 className="text-2xl font-extrabold mt-3">Zam√≥wienie</h2>
            <div className="mt-6 grid lg:grid-cols-3 gap-6 items-start">
              <div className="lg:col-span-2 bg-white border border-gray-200 rounded-2xl p-5">
                <div className="grid md:grid-cols-2 gap-4">
                  <div>
                    <label className="text-xs uppercase tracking-wider text-gray-500">Imiƒô i nazwisko *</label>
                    <input
                      value={form.imieNazwisko}
                      onChange={e=>handle('imieNazwisko', e.target.value)}
                      className="input w-full border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-brand-yellow bg-white"
                    />
                  </div>
                  <div>
                    <label className="text-xs uppercase tracking-wider text-gray-500">Nr telefonu *</label>
                    <input
                      value={form.telefon}
                      onChange={e=>handle('telefon', e.target.value)}
                      className="input w-full border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-brand-yellow bg-white"
                    />
                  </div>
                  <div>
                    <label className="text-xs uppercase tracking-wider text-gray-500">Adres email</label>
                    <input
                      value={form.email}
                      onChange={e=>handle('email', e.target.value)}
                      className="input w-full border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-brand-yellow bg-white"
                    />
                  </div>
                  <div>
                    <label className="text-xs uppercase tracking-wider text-gray-500">Miasto *</label>
                    <input
                      value={form.miasto}
                      onChange={e=>handle('miasto', e.target.value)}
                      className="input w-full border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-brand-yellow bg-white"
                    />
                  </div>
                  <div>
                    <label className="text-xs uppercase tracking-wider text-gray-500">Kod pocztowy</label>
                    <input
                      value={form.kod}
                      onChange={e=>handle('kod', e.target.value)}
                      className="input w-full border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-brand-yellow bg-white"
                    />
                  </div>
                  <div>
                    <label className="text-xs uppercase tracking-wider text-gray-500">Ulica *</label>
                    <input
                      value={form.ulica}
                      onChange={e=>handle('ulica', e.target.value)}
                      className="input w-full border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-brand-yellow bg-white"
                    />
                  </div>
                  <div>
                    <label className="text-xs uppercase tracking-wider text-gray-500">Nr budynku</label>
                    <input
                      value={form.nrBud}
                      onChange={e=>handle('nrBud', e.target.value)}
                      className="input w-full border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-brand-yellow bg-white"
                    />
                  </div>
                  <div>
                    <label className="text-xs uppercase tracking-wider text-gray-500">Piƒôtro</label>
                    <input
                      value={form.pietro}
                      onChange={e=>handle('pietro', e.target.value)}
                      className="input w-full border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-brand-yellow bg-white"
                    />
                  </div>
                  <div>
                    <label className="text-xs uppercase tracking-wider text-gray-500">Nr lokalu / mieszkania</label>
                    <input
                      value={form.lokal}
                      onChange={e=>handle('lokal', e.target.value)}
                      className="input w-full border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-brand-yellow bg-white"
                    />
                  </div>
                  <div className="md:col-span-2">
                    <label className="text-xs uppercase tracking-wider text-gray-500">Uwagi do zam√≥wienia</label>
                    <textarea
                      value={form.uwagi}
                      onChange={e=>handle('uwagi', e.target.value)}
                      className="w-full border border-gray-200 rounded-xl px-4 py-3 min-h-[100px]"
                    ></textarea>
                  </div>
                </div>
                <div className="mt-4">
                  <label className="flex items-center gap-2 text-sm">
                    <input
                      type="checkbox"
                      checked={form.faktura}
                      onChange={e=>handle('faktura', e.target.checked)}
                    />
                    Chcƒô dane do faktury
                  </label>
                  {form.faktura && (
                    <div className="grid md:grid-cols-2 gap-4 mt-3">
                      <div>
                        <label className="text-xs uppercase tracking-wider text-gray-500">NIP</label>
                        <input
                          value={form.nip}
                          onChange={e=>handle('nip', e.target.value)}
                          className="input w-full border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-brand-yellow bg-white"
                        />
                      </div>
                      <div>
                        <label className="text-xs uppercase tracking-wider text-gray-500">Nazwa firmy</label>
                        <input
                          value={form.firma}
                          onChange={e=>handle('firma', e.target.value)}
                          className="input w-full border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-brand-yellow bg-white"
                        />
                      </div>
                    </div>
                  )}
                </div>
              </div>
              <aside className="bg-white border border-gray-200 rounded-2xl p-5">
                <div className="font-semibold">Podsumowanie</div>
                <div className="mt-3 space-y-3 max-h-64 overflow-auto pr-2">
                  {cart.map(i => (
                    <div key={i.id} className="text-sm">
                      <div className="flex items-center justify-between">
                        <span className="font-medium">
                          {i.name} √ó {i.qty||1}
                        </span>
                        <span className="font-bold">{currency(lineTotal(i))}</span>
                      </div>
                      {i.items && (
                        <div className="text-gray-600 flex flex-wrap gap-1 mt-1">
                          {i.items.map(x => (
                            <span
                              key={x.id||x.name}
                              className="px-1.5 py-0.5 border border-gray-200 rounded-lg"
                            >
                              {x.name}
                            </span>
                          ))}
                        </div>
                      )}
                    </div>
                  ))}
                </div>
                <div className="flex items-center justify-between mt-4 text-lg">
                  <span className="font-bold">Do zap≈Çaty</span>
                  <span className="font-extrabold">{currency(total)}</span>
                </div>
                <button
                  onClick={submit}
                  className="w-full mt-4 bg-brand-yellow text-gray-900 font-semibold rounded-xl px-4 py-3"
                >
                  P≈Çatno≈õƒá online
                </button>
              </aside>
            </div>
          </div>
        </section>
      );
    }

    // --- Router ---
    const Router = () => {
      const [route, setRoute] = useState(window.location.hash || '#/');
      useEffect(()=>{
        const onHash = () => setRoute(window.location.hash || '#/');
        window.addEventListener('hashchange', onHash);
        return ()=> window.removeEventListener('hashchange', onHash);
      },[]);
      useEffect(()=> { lucide.createIcons(); }, [route]);

      if(route.startsWith('#/box/')) {
        const id = route.split('/')[2];
        return <BoxBuilder boxId={id} />
      }
      if(route === '#/koszyk') return <Koszyk />
      if(route === '#/zamowienie') return <Zamowienie />
      return <Home />
    }

    function getCatColor(cat){
      switch(cat){
        case 'slone': return '#F59E0B';
        case 'slodkie': return '#EC4899';
        case 'zdrowe': return '#10B981';
        case 'napoj': return '#3B82F6';
        default: return '#6B7280';
      }
    }

    const Input = (props) => (
      <input
        {...props}
        className={(props.className||'') + ' input w-full border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-brand-yellow bg-white'}
      />
    );
    const Select = (props) => (
      <select
        {...props}
        className={(props.className||'') + ' input w-full border border-gray-200 rounded-xl px-4 py-3 bg-white focus:outline-none focus:ring-2 focus:ring-brand-yellow'}
      />
    );
    const Label = ({children}) => (
      <label className="text-xs uppercase tracking-wider text-gray-500">{children}</label>
    );

    // --- Modal logowania / rejestracji ---
    const AuthModal = ({ open, onClose }) => {
      const [mode, setMode] = useState('login'); // 'login' | 'register'
      const [form, setForm] = useState({
        email: '',
        password: '',
        confirm: '',
      });

      if (!open) return null;

      const handleChange = (field, value) => {
        setForm(prev => ({ ...prev, [field]: value }));
      };

      const handleSubmit = (e) => {
        e.preventDefault();
        if (mode === 'register' && form.password !== form.confirm) {
          alert('Has≈Ça nie sƒÖ takie same.');
          return;
        }
        alert(`(${mode === 'login' ? 'Logowanie' : 'Rejestracja'}) to na razie makieta UI :)`);
        onClose();
      };

      const switchToRegister = () => {
        setMode('register');
        setForm({ email: '', password: '', confirm: '' });
      };

      const switchToLogin = () => {
        setMode('login');
        setForm({ email: '', password: '', confirm: '' });
      };

      return (
        <div
          className="fixed inset-0 z-[90] bg-black/60 flex items-center justify-center px-4"
          onClick={onClose}
          role="dialog"
          aria-modal="true"
        >
          <div
            className="relative w-full max-w-md bg-white rounded-2xl shadow-glass border border-gray-200 p-6"
            onClick={(e) => e.stopPropagation()}
          >
            <button
              type="button"
              onClick={onClose}
              className="absolute top-3 right-3 p-2 rounded-full bg-white border border-gray-200 shadow-soft hover:bg-gray-50"
              aria-label="Zamknij okno logowania"
            >
              <i data-lucide="x" className="w-4 h-4"></i>
            </button>

            <div className="mb-4">
              <div className="text-xs uppercase tracking-[0.16em] text-gray-500 font-semibold">
                {mode === 'login' ? 'Logowanie' : 'Rejestracja'}
              </div>
              <h3 className="text-xl font-extrabold mt-1">
                {mode === 'login' ? 'Zaloguj siƒô do eatmi' : 'Za≈Ç√≥≈º konto w eatmi'}
              </h3>
              <p className="text-xs text-gray-500 mt-1">
                {mode === 'login'
                  ? 'Zamawiaj szybciej, zapisuj ulubione zestawy i ≈õled≈∫ historiƒô zam√≥wie≈Ñ (makieta).'
                  : 'Utw√≥rz konto, aby w przysz≈Ço≈õci zapisywaƒá swoje boxy i dane dostawy (makieta UI).'}
              </p>
            </div>

            {/* Social logins: tylko Google i Apple */}
            <div className="flex flex-col gap-2 mb-4">
              <button
                type="button"
                className="btn flex w-full items-center justify-center gap-2 rounded-[10px] border border-[#ededef] bg-white px-3 py-2 text-sm font-medium hover:border-[#2d79f3] transition"
              >
                <span className="inline-flex h-5 w-5 items-center justify-center">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 48 48"
                    className="h-5 w-5"
                    aria-hidden="true"
                  >
                    <path fill="#EA4335" d="M24 9.5c3.54 0 6 1.54 7.38 2.84l5.42-5.42C33.64 3.58 29.3 1.5 24 1.5 14.88 1.5 7.09 6.98 3.66 14.72l6.77 5.26C11.86 14.33 17.38 9.5 24 9.5z"/>
                    <path fill="#4285F4" d="M46.5 24.5c0-1.57-.14-3.08-.41-4.5H24v9h12.7c-.55 2.92-2.22 5.4-4.73 7.07l7.64 5.93C43.86 38.63 46.5 32.1 46.5 24.5z"/>
                    <path fill="#FBBC05" d="M10.43 28.22a14.5 14.5 0 010-8.44L3.66 14.72A22.43 22.43 0 001.5 24.5c0 3.65.87 7.1 2.16 10.03l6.77-5.26z"/>
                    <path fill="#34A853" d="M24 47.5c5.85 0 10.77-1.93 14.36-5.47l-7.64-5.93C28.73 37.54 26.53 38.5 24 38.5c-6.62 0-12.14-4.83-13.57-11.28l-6.77 5.26C7.09 42.02 14.88 47.5 24 47.5z"/>
                    <path fill="none" d="M1.5 1.5h45v45h-45z"/>
                  </svg>
                </span>
                <span>Zaloguj siƒô przez Google</span>
              </button>

              <button
                type="button"
                className="btn flex w-full items-center justify-center gap-2 rounded-[10px] border border-[#ededef] bg-white px-3 py-2 text-sm font-medium hover:border-[#2d79f3] transition"
              >
                <span className="inline-flex h-5 w-5 items-center justify-center">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 384 512"
                    className="h-5 w-5"
                    aria-hidden="true"
                  >
                    <path
                      fill="currentColor"
                      d="M318.7 268.7c.5 55.4 48.6 73.8 49.1 74-0.4 1.3-7.7 26.3-25.4 52.1-15.3 22.4-31.2 44.7-56.3 45.1-24.6.4-32.5-14.6-60.6-14.6-28.1 0-37 14.2-60.4 15-24.3.9-42.8-24.2-58.1-46.5-31.6-45.9-55.8-129.6-23.4-186.2 16.2-28.2 45.1-46.1 76.5-46.5 23.9-.5 46.4 16 60.6 16 14.2 0 41.7-19.8 70.3-16.9 12 0.5 45.7 4.9 67.4 37-1.7 1-40.1 23.4-39.7 69.5zm-46.4-135.6c12.9-15.6 21.6-37.4 19.2-59.1-18.5.7-40.8 12.3-54 27.9-11.9 13.8-22.4 36-19.6 57.3 20.7 1.6 41.9-10.5 54.4-26.1z"
                    />
                  </svg>
                </span>
                <span>Zaloguj siƒô przez Apple</span>
              </button>
            </div>

            <div className="flex items-center gap-2 mb-4">
              <div className="h-px flex-1 bg-gray-200" />
              <span className="text-[11px] uppercase tracking-[0.16em] text-gray-400">
                lub {mode === 'login' ? 'e-mail i has≈Ço' : 'zarejestruj siƒô mailem'}
              </span>
              <div className="h-px flex-1 bg-gray-200" />
            </div>

            {/* Formularz e-mail + has≈Ço */}
            <form onSubmit={handleSubmit} className="space-y-3">
              <div>
                <Label>Adres e-mail</Label>
                <Input
                  type="email"
                  required
                  value={form.email}
                  onChange={(e) => handleChange('email', e.target.value)}
                  placeholder="np. jan.kowalski@example.com"
                  className="mt-1"
                />
              </div>

              <div>
                <Label>Has≈Ço</Label>
                <Input
                  type="password"
                  required
                  value={form.password}
                  onChange={(e) => handleChange('password', e.target.value)}
                  placeholder="Wpisz has≈Ço"
                  className="mt-1"
                />
              </div>

              {mode === 'register' && (
                <div>
                  <Label>Powt√≥rz has≈Ço</Label>
                  <Input
                    type="password"
                    required
                    value={form.confirm}
                    onChange={(e) => handleChange('confirm', e.target.value)}
                    placeholder="Powt√≥rz has≈Ço"
                    className="mt-1"
                  />
                </div>
              )}

              {mode === 'login' && (
                <div className="flex justify-end">
                  <button
                    type="button"
                    className="text-xs text-gray-500 hover:text-gray-700 underline underline-offset-2"
                  >
                    Zapomnia≈Çem has≈Ça
                  </button>
                </div>
              )}

              <button
                type="submit"
                className="button-submit w-full mt-1 bg-gray-900 text-white font-semibold rounded-xl px-4 py-3 text-sm hover:bg-black"
              >
                {mode === 'login' ? 'Zaloguj siƒô' : 'Zarejestruj siƒô'}
              </button>
            </form>

            <div className="mt-4 text-xs text-gray-600 text-center">
              {mode === 'login' ? (
                <>
                  Nie masz jeszcze konta?{' '}
                  <button
                    type="button"
                    onClick={switchToRegister}
                    className="span font-semibold text-gray-900 underline underline-offset-2"
                  >
                    Zarejestruj siƒô
                  </button>
                </>
              ) : (
                <>
                  Masz ju≈º konto?{' '}
                  <button
                    type="button"
                    onClick={switchToLogin}
                    className="span font-semibold text-gray-900 underline underline-offset-2"
                  >
                    Zaloguj siƒô
                  </button>
                </>
              )}
            </div>
          </div>
        </div>
      );
    };

    // --- Home ---
    const Home = () => {
      const { add } = useCart();
      return (
        <>
          <Hero />

          <section id="zapakuj" className="py-12 md:py-20 bg-gradient-to-b from-white to-brand-light">
            <div className="max-w-6xl mx-auto px-4">
              <SectionTitle
                eyebrow="Konfigurator"
                title="Zapakuj swojego boxa"
                subtitle="Wybierz rozmiar boxa (ma≈Çy, ≈õredni, du≈ºy) i skomponuj idealny zestaw metodƒÖ przeciƒÖgnij-i-upu≈õƒá."
              />
              <div className="mt-8 grid md:grid-cols-3 gap-6">
                {Object.entries(BOX_RULES).map(([id, def]) => (
                  <BoxCard
                    key={id}
                    id={id}
                    name={def.name}
                    limits={def.limits}
                    price={def.price}
                  />
                ))}
              </div>
            </div>
          </section>

          <section id="sniadanie" className="py-12 md:py-20">
            <div className="max-w-6xl mx-auto px-4">
              <SectionTitle
                eyebrow="Oferta ≈õniadaniowa"
                title="Boxy ≈õniadaniowe"
                subtitle="Gotowe zestawy ≈õniadaniowe w trzech rozmiarach ‚Äî ka≈ºdy w wersji klasycznej oraz vege."
              />
              <div className="mt-8 grid md:grid-cols-3 gap-6">
                {BREAKFAST_BOXES.map(bx => (
                  <BreakfastBoxCard
                    key={bx.id}
                    box={bx}
                    onAdd={(variant) =>
                      add({
                        type: 'breakfast-box',
                        name: `${bx.name} ‚Äî ${variant.label}`,
                        price: bx.price,
                        items: variant.items,
                      })
                    }
                  />
                ))}
              </div>
            </div>
          </section>

          <section id="oferta" className="py-12 md:py-20">
            <div className="max-w-6xl mx-auto px-4">
              <SectionTitle
                eyebrow="Oferta lunchowa"
                title="Lunch boxy"
                subtitle="Szybkie zestawy lunchowe ‚Äî idealne na przerwƒô w pracy lub na wynos."
              />
            <div className="mt-8 grid md:grid-cols-3 gap-6">
              {LUNCH_BOXES.map(rb => (
                <LunchBoxCard
                  key={rb.id}
                  box={rb}
                  onAdd={()=> add({ type:'lunch-box', name: rb.name, price: rb.price, items: rb.items })}
                />
              ))}
            </div>
            </div>
          </section>

          <section id="o-nas" className="py-12">
            <div className="max-w-6xl mx-auto px-4 grid md:grid-cols-2 gap-10 items-center">
              <img
                className="w-full rounded-2xl shadow-soft"
                loading="lazy"
                src="https://images.unsplash.com/photo-1526318472351-c75fcf070305?q=80&w=1400&auto=format&fit=crop"
                alt="Kuchnia Eatmi"
              />
              <div>
                <SectionTitle
                  title="Jako≈õƒá & prostota"
                  subtitle="Stawiamy na ≈õwie≈ºo≈õƒá, przejrzysto≈õƒá i szybkie zam√≥wienia."
                />
                <ul className="mt-4 space-y-2 text-gray-700">
                  <li className="flex gap-3">
                    <i data-lucide="check-circle" className="w-5 h-5 text-brand-yellow"></i>
                    ≈öwie≈ºe sk≈Çadniki ka≈ºdego dnia
                  </li>
                  <li className="flex gap-3">
                    <i data-lucide="check-circle" className="w-5 h-5 text-brand-yellow"></i>
                    Zam√≥wienia online w kilka klik√≥w
                  </li>
                  <li className="flex gap-3">
                    <i data-lucide="check-circle" className="w-5 h-5 text-brand-yellow"></i>
                    Dostawa na czas
                  </li>
                </ul>
              </div>
            </div>
          </section>

          <section id="kontakt" className="py-12 bg-white">
            <div className="max-w-6xl mx-auto px-4">
              <SectionTitle
                title="Kontakt"
                subtitle="Masz pytania? Napisz do nas."
              />
              <form className="max-w-xl mx-auto mt-8 bg-white border border-gray-200 rounded-2xl p-6 shadow-soft">
                <div className="grid md:grid-cols-2 gap-4">
                  <input className="input w-full border border-gray-200 rounded-xl px-4 py-3" placeholder="Imiƒô" />
                  <input className="input w-full border border-gray-200 rounded-xl px-4 py-3" placeholder="Email" />
                </div>
                <textarea
                  className="input w-full border border-gray-200 rounded-xl px-4 py-3 mt-4"
                  rows="4"
                  placeholder="Wiadomo≈õƒá"
                ></textarea>
                <button
                  type="button"
                  className="mt-4 bg-gray-900 text-white rounded-xl px-5 py-3 font-semibold"
                >
                  Wy≈õlij
                </button>
              </form>
            </div>
          </section>
        </>
      )
    };

    const FloatingNav = () => (
      <nav className="fixed bottom-4 left-1/2 -translate-x-1/2 z-50 w-[min(720px,92%)] liquid border border-white/50 rounded-2xl shadow-glass">
        <ul className="grid grid-cols-4">
          <li>
            <a href="#zapakuj" className="flex flex-col items-center py-3 text-sm font-medium">
              <i data-lucide="shopping-bag" className="w-5 h-5"></i>
              Zam√≥w
            </a>
          </li>
          <li>
            <a href="#sniadanie" className="flex flex-col items-center py-3 text-sm font-medium">
              <i data-lucide="sunrise" className="w-5 h-5"></i>
              ≈öniadania
            </a>
          </li>
          <li>
            <a href="#oferta" className="flex flex-col items-center py-3 text-sm font-medium">
              <i data-lucide="app-window" className="w-5 h-5"></i>
              Lunch
            </a>
          </li>
          <li>
            <a href="#kontakt" className="flex flex-col items-center py-3 text-sm font-medium">
              <i data-lucide="message-square" className="w-5 h-5"></i>
              Kontakt
            </a>
          </li>
        </ul>
      </nav>
    );

    const App = () => {
      const [authOpen, setAuthOpen] = useState(false);

      useEffect(() => {
        // od≈õwie≈º ikony, gdy otwieramy / zamykamy modal
        lucide.createIcons();
      }, [authOpen]);

      return (
        <ToastProvider>
          <CartProvider>
            <Header onOpenAuth={() => setAuthOpen(true)} />
            <Router />
            <FloatingNav />
            <footer className="py-16 text-center text-sm text-gray-500">
              ¬© {new Date().getFullYear()} eatmi.pl ‚Ä¢ Wszystkie prawa zastrze≈ºone
            </footer>

            <AuthModal open={authOpen} onClose={() => setAuthOpen(false)} />
          </CartProvider>
        </ToastProvider>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
